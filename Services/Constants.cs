namespace ClaudeCodeApiConfigManager.Services;

/// <summary>
/// 全局常量定义
/// </summary>
public static class Constants
{
    /// <summary>
    /// 环境变量名称
    /// </summary>
    public static class EnvVars
    {
        public const string AuthToken = "ANTHROPIC_AUTH_TOKEN";
        public const string BaseUrl = "ANTHROPIC_BASE_URL";
        public const string Model = "ANTHROPIC_MODEL";
        public const string CcmHome = "CCM_HOME";
    }

    /// <summary>
    /// Shell 脚本标记
    /// </summary>
    public static class ShellMarkers
    {
        public const string CcmMarker = "# ccm - Claude Code Config Manager";
    }

    /// <summary>
    /// URL 前缀
    /// </summary>
    public static class UrlPrefixes
    {
        public const string Http = "http://";
        public const string Https = "https://";
    }

    /// <summary>
    /// API Token 前缀
    /// </summary>
    public const string ApiTokenPrefix = "sk-";

    /// <summary>
    /// 目录名称
    /// </summary>
    public static class Dirs
    {
        public const string CcmDir = ".ccm";
        public const string ConfigDir = "ClaudeCodeApiConfigManager";
        public const string FishConfigDir = "fish";
    }

    /// <summary>
    /// 文件名称
    /// </summary>
    public static class Files
    {
        public const string Settings = "settings.json";
        public const string BashEnv = "env.sh";
        public const string FishEnv = "env.fish";
        public const string Bashrc = ".bashrc";
        public const string BashProfile = ".bash_profile";
        public const string Zshrc = ".zshrc";
        public const string FishConfig = "config.fish";
        public const string UninstallBatName = "uninstall.bat";
    }

    /// <summary>
    /// 用户提示消息
    /// </summary>
    public static class Messages
    {
        public const string WindowsEnvUpdate = "环境变量已更新。";
        public const string WindowsRestartHint = "打开新终端窗口 或 重启ClaudeCode程序 使更改生效。";
        public const string UnixEnvUpdate = "环境变量已更新。";
        public const string UnixRunCmdEffective = "运行以下命令使更改立即生效：";
        public const string UnixOpenNewWindowEffective = "或打开新终端窗口自动生效。";
        public const string FileAutoGenerated = "# 此文件由 ccm 自动生成，请勿手动编辑";
        public const string WelcomeMessage = "欢迎使用 Claude Code API 配置管理器（ccm）。";
        public const string InstallationComplete = "安装完成！";
        public const string UninstallComplete = "ccm 已卸载。";
        public const string FileAlreadyExists = "已存在";
        public const string AskOverwrite = "是否覆盖？";
        public const string AskContinue = "是否继续？";
        public const string AskRemoveConfig = "是否同时删除配置文件？";
        public const string ConfigFileCreated = "配置文件已创建";
        public const string ConfigFileDeleted = "配置文件已删除";
        public const string GlobalCommandInstalled = "全局命令已安装";
        public const string RemovedFromPath = "已从 PATH 移除";
        public const string SymlinkDeleted = "符号链接已删除";
        public const string InstallDirDeleted = "安装目录已删除";
        public const string ConfigDirDeleted = "配置目录已删除";
    }

    /// <summary>
    /// 安装相关常量
    /// </summary>
    public static class Install
    {
        public const string WinCcmDir = ".ccm";
        public const string WinExeName = "ccm.exe";
        public const string PdbFileName = "ccm.pdb";
        public const string UnixExeName = "ccm";
        public const string LocalBinDir = ".local/bin";
        public const string UsrLocalBinDir = "/usr/local/bin";
    }

    /// <summary>
    /// 配置模板
    /// </summary>
    public static class ConfigTemplates
    {
        /// <summary>
        /// 默认配置文件的 JSON 内容
        /// </summary>
        public const string DefaultSettingsJson = """
        {
          "configs": [
            {
              "name": "zhipu",
              "authToken": "",
              "baseUrl": "https://open.bigmodel.cn/api/anthropic",
              "model": "glm-4.7",
              "customParams": {}
            },
            {
              "name": "ds",
              "authToken": "",
              "baseUrl": "https://api.deepseek.com/anthropic",
              "model": "deepseek-chat",
              "customParams": {}
            },
            {
              "name": "minimax",
              "authToken": "",
              "baseUrl": "https://api.minimaxi.com/anthropic",
              "model": "MiniMax-M2.1",
              "customParams": {}
            },
            {
              "name": "kimi",
              "authToken": "",
              "baseUrl": "https://api.moonshot.cn/anthropic",
              "model": "kimi-k2.5",
              "customParams": {}
            },
            {
              "name": "qwen3",
              "authToken": "",
              "baseUrl": "https://dashscope.aliyuncs.com/apps/anthropic",
              "model": "qwen3-coder-plus",
              "customParams": {}
            },
            {
              "name": "qwen3-coding",
              "authToken": "",
              "baseUrl": "https://coding.dashscope.aliyuncs.com/apps/anthropic",
              "model": "qwen3-coder-plus",
              "customParams": {}
            }
          ],
          "activeConfigName": null
        }
        """;
    }

    public const string UninstallScript = """
@echo off
chcp 65001 >nul
dir /b "%~dp0*" 2>nul | find /v "uninstall.bat" | find /v "ccm.exe" | findstr . >nul
if %errorlevel% neq 0 (
    del "%~dp0ccm.exe" 2>nul
    echo 卸载完成！程序文件和目录已全部删除。
    > "%temp%\delself.bat" (
        echo @echo off
        echo timeout /t 1 /nobreak ^>nul
        echo rmdir /s /q "%~dp0" 2^>nul
        echo del "%%0" 2^>nul
    )
    start "" /min cmd /c "%temp%\delself.bat"
) else (
    del "%~dp0ccm.exe" 2>nul
    echo 卸载完成！程序文件已删除。
    > "%temp%\delself.bat" (
        echo @echo off
        echo timeout /t 1 /nobreak ^>nul
        echo del /f "%~f0" 2^>nul
        echo del "%%0" 2^>nul
    )
    start "" /min cmd /c "%temp%\delself.bat"
)
exit
""";

}
